### 观察者模式

```java

 
    public static void main(String[] args) {
        FunctionObservableRunnable functionObservableRunnable = new FunctionObservableRunnable();
        //添加观察者 监听器
        functionObservableRunnable.addObserver(new RestartThreadObserver());
        new Thread(functionObservableRunnable).start();
    }



   static class RestartThreadObserver implements Observer {
        /**
         * 状态发生变化 接到通知时 就执行此方法
         * @param o
         * @param arg
         */
        @Override
        public void update(Observable o, Object arg) {
            FunctionObservableRunnable functionObservableRunnable = new FunctionObservableRunnable();
            functionObservableRunnable.addObserver(this);
            new Thread(functionObservableRunnable).start();
        }
    }

    static class FunctionObservableRunnable extends Observable implements Runnable {

        /**
         * 告诉观察者 要重启线程
         */
        private void tellObserverToRestart(){
            setChanged();
            notifyObservers();
        }

        @Override
        public void run() {
            try {
                functionMethod();
            } catch (Exception e) {
                e.printStackTrace();
                tellObserverToRestart();
                return;
            }
        }

        public void functionMethod() throws Exception {
            int count = 0;
            while (true) {
                count++;
                System.out.println(count);
                //模拟线程运行了一段时间
                Thread.sleep(1000 * 5);
                if (count == 4) {
                    String[] strings = new String[]{"hello", "world"};
                    //产生 NPE 线程退出
                    System.out.println(strings[2]);
                }
            }
        }
        
    }
```